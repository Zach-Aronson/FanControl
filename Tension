from gpiozero import Servo, Button
from gpiozero.pins.pigpio import PiGPIOFactory
from signal import pause
from time import sleep

# Setup for precise PWM and input reading
factory = PiGPIOFactory()
servo = Servo(24, min_pulse_width=0.0006, max_pulse_width=0.0024, pin_factory=factory)
switch = Button(23, pull_up=False)  # Pull-down logic

# Track servo angle (for logging)
current_angle = None

def set_angle(degrees):
    global current_angle
    degrees = max(0, min(180, degrees))
    value = (degrees - 90) / 90
    servo.value = value
    current_angle = degrees
    print(f"Servo moved instantly to {degrees}°")

# Actions based on toggle switch state
def to_switch(): 
    set_angle(80)

def to_base_position():
    set_angle(0)

# Set up event triggers
switch.when_pressed = to_base_position
switch.when_released = to_swtich 

# Initialize at 60°
to_sixty_degrees()

pause()  # Keep the program alive 


